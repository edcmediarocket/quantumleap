
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Daily Signals: Allow public read, no client-side writes
    match /dailySignals/{signalId} {
      allow read: if true;
      allow write: if false; // Writes should only come from backend/admin
    }

    // User Preferences (Example: if users can set notification preferences)
    // Users can read and write their own preferences document
    match /users/{userId}/preferences/{prefId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Admin Settings: Make feature toggles publicly readable for simplicity.
    // Writes are restricted to the specific Admin UID.
    match /adminSettings/{settingId} {
      allow read: if true; // Feature toggles can be public
      allow write: if request.auth != null && request.auth.uid == 'qRJOtYXWqLbpQ1yx6qRdwSGwGyl1'; // Specific Admin UID
    }

    // Coach Logs: Only backend writes (via function) and no client reads by default.
    match /coachLogs/{logId} {
      allow read: if false;
      allow write: if false; // Writes are from backend
    }

    // Default deny all other access to prevent unintended open collections
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
