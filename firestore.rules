
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Daily Signals: Publicly readable, but writable only by backend functions.
    match /dailySignals/{signalId} {
      allow read: if true;
      allow write: if false; // Writes should come from backend functions
    }

    // User-specific data: Typically, users can read/write their own data.
    match /users/{userId}/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Admin Settings: Readable by authenticated users (for feature toggles),
    // writable only by authenticated users (admin UID check done in app/functions).
    // For stricter security, you might restrict read to specific admin roles via custom claims.
    match /adminSettings/{settingId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null; // Further admin checks should be in your Cloud Functions or app logic
    }

    // Coach Logs: Generally, these should only be writable by your backend functions.
    // Read access might be restricted to admins or users for their own logs.
    // This rule assumes writes only from backend and denies client reads/writes.
    match /coachLogs/{logId} {
      allow read, write: if false; // Writes from backend, client reads TBD based on needs
    }

    // Default deny all other access
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
